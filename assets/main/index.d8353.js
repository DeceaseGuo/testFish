window.__require=function e(t,o,n){function r(i,l){if(!o[i]){if(!t[i]){var a=i.split("/");if(a=a[a.length-1],!t[a]){var u="function"==typeof __require&&__require;if(!l&&u)return u(a,!0);if(c)return c(a,!0);throw new Error("Cannot find module '"+i+"'")}i=a}var s=o[i]={exports:{}};t[i][0].call(s.exports,function(e){return r(t[i][1][e]||e)},s,s.exports,e,t,o,n)}return o[i].exports}for(var c="function"==typeof __require&&__require,i=0;i<n.length;i++)r(n[i]);return r}({LoadBundle:[function(e,t,o){"use strict";cc._RF.push(t,"c0c2cxrOxRCmLQ9Bd4TT9u5","LoadBundle");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),c=this&&this.__decorate||function(e,t,o,n){var r,c=arguments.length,i=c<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(c<3?r(i):c>3?r(t,o,i):r(t,o))||i);return c>3&&i&&Object.defineProperty(t,o,i),i},i=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(r,c){function i(e){try{a(n.next(e))}catch(t){c(t)}}function l(e){try{a(n.throw(e))}catch(t){c(t)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(i,l)}a((n=n.apply(e,t||[])).next())})},l=this&&this.__generator||function(e,t){var o,n,r,c,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(e){return function(t){return a([e,t])}}function a(c){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(r=2&c[0]?n.return:c[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,c[1])).done)return r;switch(n=0,r&&(c=[2&c[0],r.value]),c[0]){case 0:case 1:r=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!r||c[1]>r[0]&&c[1]<r[3])){i.label=c[1];break}if(6===c[0]&&i.label<r[1]){i.label=r[1],r=c;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(c);break}r[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(l){c=[6,l],n=0}finally{o=r=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,u=a.ccclass,s=a.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fishicon=[],t}return r(t,e),t.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){e.keyCode===cc.macro.KEY.z?(cc.log("Z \u9375\u88ab\u6309\u4e0b"),this.testLoad()):e.keyCode===cc.macro.KEY.x?(cc.log("X \u9375\u88ab\u6309\u4e0b"),this.secondLoad()):e.keyCode===cc.macro.KEY.q?(cc.log("Q \u9375\u88ab\u6309\u4e0b"),this.preloadScenes("PlistBundle","Game",0)):e.keyCode===cc.macro.KEY.w?(cc.log("W \u9375\u88ab\u6309\u4e0b"),this.preloadScenes("PlistOldBundle","Game",0)):e.keyCode===cc.macro.KEY.e?(cc.log("E \u9375\u88ab\u6309\u4e0b"),this.testOldLoad()):e.keyCode===cc.macro.KEY.r?(cc.log("R \u9375\u88ab\u6309\u4e0b"),cc.director.loadScene("PlistBundle/scene/Game")):e.keyCode===cc.macro.KEY.p&&(cc.log("P \u9375\u88ab\u6309\u4e0b"),cc.log("onlyLoad"),this.oldLoadBundle("PlistBundle"))},t.prototype.testLoad=function(){var e=this;cc.assetManager.loadBundle("TestBundle",function(t,o){t?console.error("\u8f09\u5165 bundle \u5931\u6557",t):o.load("AutoAtlas",cc.SpriteAtlas,function(t,o){if(t)console.error("\u8f09\u5165 SpriteFrame \u5931\u6557",t);else{console.log("\u8f09\u5165\u5b8c\u6210",o);var n=o.getSpriteFrame("ButterflyRSC_lock");e.fishicon[0].spriteFrame=n;var r=o.getSpriteFrame("ClownRSC_lock");e.fishicon[1].spriteFrame=r;var c=o.getSpriteFrame("DragonCarp_lock");e.fishicon[2].spriteFrame=c}})})},t.prototype.secondLoad=function(){var e=this;cc.assetManager.loadBundle("MyIcon",function(t,o){t?console.error("\u8f09\u5165 bundle \u5931\u6557",t):o.load("TestIcon",cc.Texture2D,function(t,o){if(t)console.error("\u8f09\u5165 TestIcon \u5931\u6557",t);else{console.log("\u8f09\u5165\u5b8c\u6210",o);for(var n=0;n<3;n++){var r=new cc.SpriteFrame;r.setTexture(o),r.setRect(new cc.Rect(140*n,0,140,160)),e.fishicon[n].spriteFrame=r}}})})},t.prototype.preloadScenes=function(e,t,o){var n=this;return new Promise(function(r){n.loadBundle(e).then(function(e){e.loadScene("scene/"+t,function(e,t){n.refreshProgress(o,e,t)},function(e,t){e&&(cc.error(e),r(null)),cc.log("\u52a0\u8f09game scene \u6210\u529f"),cc.director.runScene(t),r(t)})})})},t.prototype.refreshProgress=function(e,t,o){var n=e+t/o;cc.log("loading_resource",[Math.floor(100*n)+""])},t.prototype.loadBundle=function(e){return new Promise(function(t){cc.assetManager.loadBundle(e,function(){},function(e,o){if(e)return cc.error("ddt "+e),void t(null);cc.log("\u52a0\u8f09PlistBundle\u6210\u529f"),t(o)})})},t.prototype.testOldLoad=function(){cc.log("\u958b\u59cb\u5de8\u9be8\u8b80\u53d6\u65b9\u5f0f"),cc.assetManager.getBundle("PlistBundle")?cc.log("\u53d6\u5f97\u5de8\u9be8bundle\u6210\u529f"):(cc.log("\u53d6\u5f97\u5de8\u9be8bundle\u5931\u6557"),this.oldLoadBundle("PlistBundle"))},t.prototype.oldLoadBundle=function(e){return i(this,void 0,Promise,function(){return l(this,function(){return[2,new Promise(function(t,o){cc.assetManager.loadBundle(e,function(e,n){e?(cc.error("\u5de8\u9be8\u8b80\u53d6\u65b9\u5f0f \u5931\u6557"),o(e)):n&&(cc.log("\u5de8\u9be8\u8b80\u53d6\u65b9\u5f0f \u6210\u529f"),t(n))})})]})})},c([s(cc.Sprite)],t.prototype,"fishicon",void 0),c([u],t)}(cc.Component);o.default=f,cc._RF.pop()},{}]},{},["LoadBundle"]);